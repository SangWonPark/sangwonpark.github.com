---
title: "네트워크: PC간 통신이 이루어지는 과정과 방식에 대하여"
date: 2022-01-16
last_modified_at: 2022-01-20T19:00:00
header:
  overlay_color: "#333"
layout: single
classes: wide
categories:
  - network
tags:
  - LAN
  - MAC Address
  - ARP
  - 캐스트
  - OSI 7 LAYER
  - 물리 계층
  - 데이터링크 계층

toc: true
toc_sticky: true
toc_label: "목차"
---

_컴퓨터간 통신을 할 때 어떤 방식으로 서로를 인식하고 통신할까?_

네트워크관련 첫 포스팅으로 네트워크에 대해 공부한 내용을 정리해 나가려 합니다.
네트워크에 대한 첫 게시물인 만큼 먼저 물리적인 케이블(LAN과 WAN)에 대해 간단하게 알아보며 PC 간에 통신이 어떻게 이루어지는지에 대해 간단하게 알아보겠습니다.

### LAN과 WAN
* LAN: Local Area Network
* WAN: Wide Area Network

위 약자를 풀어보면 알 수 있듯이 LAN은 한정된 지역에서의 네트워크를 구축하는 것이고, WAN은 멀리 떨어진 지역을 연결하는 것입니다.
요즘엔 어디서든 인터넷에 접속하기 때문에 LAN과 WAN을 모두 사용한다고 볼 수 있습니다.

### 인터넷
우리는 WAN을 통해 멀리 떨어진 지역과 통신할 수 있고, 이를 '네트워킹 한다'라고 말한다고 합니다.
네트워킹을 하는 방식이 딱 한가지만 있는것이 아니라 여러가지 방식이 존재 하는데요. 우리나라는 그 중 이더넷 방식을 통해 네트워크를 만든다고 합니다.

### 이더넷과 CSMA/CD 프로토콜
이더넷 방식은 CSMA/CD 프로토콜을 사용해 통신한다고 합니다. 그럼 CSMA/CD프로토콜은 무엇일까요?
먼저 프로토콜에 대해 간단히 설명하자면 우리가 타인과 소통할 때 사용하는 언어라고 볼 수 있을것 같습니다. 서로 다른언어로는 대화가 되지 않듯이 서로 다른 프로토콜을 사용하는 컴퓨터간에는 제대로된 통신이 이루어질 수 없겠죠?

그럼 이제 CSMA/CD 프로토콜에 대해 알아보죠
* CSMA/CD: Carrier Sense Multiple Access/Collision Detection
  * '대충 알아서 눈치로 통신하자' 입니다.
  * PC는 네트워크상에 이미 통신중인 PC가 있다면 통신을 하고싶어도 통신이 끝날 때 까지 기다립니다.(Carrier Sense)
  * 네트워크상에 통신이 일어나지 않게 되면 통신을 기다리던 다른 PC는 네트워크상에 데이터를 실어 보냅니다. 이때 동시에 여러대의 컴퓨터가 데이터를 실어보낼 수 있습니다.(Multiple Access)
  * 네트워크상에 2개 이상의 장비에서 데이터를 동시에 보내려고하면 충돌(Collision)이 발생합니다.
  * 네트워크에 데이터를 실어보내고 충돌이 발생하지 않았는지 점검합니다.(Collision Detection)
  * 충돌이 발생하면 데이터를 전송했던 PC들은 랜덤한 시간동안 기다렸다가 다시 데이터를 전송하며, 15번을 해도 충돌이난다면 포기하게 됩니다.

### 맥 어드레스(MAC Address)
* MAC: Media Access Control
* MAC Address:
  * 48bit 8개의 비트(octet)씩 묶어 16진수로 표현합니다.

컴퓨터가 네트워크상에서 서로를 구분하는 일종의 주소가 필요한데 이 역할을 담당하는 것이 MAC입니다.
TCP/IP 프로토콜에서는 IP 주소를 사용해 통신을 하지만 이때 MAC 주소도 사용하게 되고, IP주소를 MAC주소로 변환하는 작업이 이루어지는데, 이를 ARP라고 합니다.

#### ARP
* ARP: Address Resolution Protocol

우리가 사용하는 PC는 랜카드가 있다면 모두 MAC 주소를 갖고 있습니다. 랜카드에 부여된 MAC 주소는 전 세계에서 겹치지 않는 하나뿐인 유일한 주소입니다.

TCP/IP 통신을 하는 인터넷에서는 어떻게 다른 PC의 MAC 주소를 알아낼까요?
간단하게 ARP가 이루어지는 순서에 대해서 알아보겠습니다.
PC-A가 PC-B와 통신하려하고, A는 B의 IP주소를 알고있습니다.
1. A는 먼저 자신이 속한 네트워크의 모든 PC에 메시지를 보냅니다.(ARP request, 브로트캐스트)
2. B에서 A가 보낸 요청을 받으면 자신의 MAC 주소를 네트워크에 실어 A에게 보냅니다.
3. B의 MAC 주소를 알게된 A는 비로소 B와 통신을 하게 됩니다.

위 경우는 같은 네트워크에 PC가 있을 경우의 ARP 과정입니다. 만일 서로 다른 네트워크에 있는 PC간 통신은 어떤 과정을 통해 이루어지게 될까요?
(PC-A와 PC-B는 서로 다른 두 네트워크는 라우터를 통해 연결되어있다고 가정합니다.)
1. A는 먼저 자신이 속한 네트워크의 모든 PC에 메시지를 보냅니다.(ARP request, 브로트캐스트)
2. B는 다른 네트워크에 있으므로 이 요청을 받지 못하고, B의 MAC 주소를 A는 알 수 없게 됩니다. 하지만 A가 연결된 네트워크에 B가 없다는 것을 알고있는 라우터는 자신의 MAC 주소를 A에게 보내게됩니다.
3. A는 라우터의 맥 주소로 데이터를 보내게 되고, 라우터는 이 데이터를 B의 네트워크에 보내게 됩니다.
4. A 네트워크의 라우터는 B에게 데이터를 보내기 위해 B가 있는 네트워크의 라우터에게 전달하고, B 네트워크의 라우터는 B의 MAC 주소를 알아낸 후 B에게 데이터를 전송하게 됩니다.

### 유니캐스트, 브로드배스트, 멀티캐스트
ARP를 설명하며 언급되었던 브로드캐스트라는 용어가 있었는데요. 네트워크 통신을하는 방식에 대한 구분입니다.
유니캐스트, 브로드캐스트 멀티캐스트에 대해 알아보겠습니다.

#### 유니캐스트
현재 우리가 네트워크상에서 가장 많이 사용되는 트래픽으로 출발지의 PC 주소와 목적지 PC 주소가 분명한 통신 방식으로 출발지와 목적지의 MAC 주소가 각각 하나씩 이어야합니다.

유니캐스트 프레임을 네트워크에 뿌리게 되면 같은 이더넷에 붙어있는 모든 PC의 랜카드에서 이 프레임을 받아들여 자신의 MAC 주소와 비교 후 일치하면 받아들여 CPU로 보내고, 일치하지 않을 경우 해당 요청을 버립니다.

유니캐스트의 경우 목적지 주소가 아닌 다른 PC들의 CPU 성능을 저하시키지 않습니다.

#### 브로드캐스트
내가 있는 네트워크 안의 모든 장비에 통신할 때 쓰기위한 방식입니다.

MAC 주소를 FFFF.FFFF.FFFF로 했을 경우 브로드캐스트로 인식하며, 랜카드에서는 프레임을 CPU로 올리게 됩니다.
따라서 브로드캐스트가 많이 발생하는 네트워크의 경우 PC의 CPU 성능을 저하시킵니다.

위에서 알아본 ARP의 경우 브로드캐스트로 통신하게 되고, 라우터끼리 정보를 교환하거나 네트워크상의 모든 장비에 어떠한 정보를 알릴경우 사용됩니다.

#### 멀티캐스트
보내고자하는 그룹 멤버들에게 한 번에 보낼 수 있습니다. 즉 그 그룹에 속해있는 사람들에게만 선택적으로 한 번에 보낼 수 있는겁니다.

멀티캐스트를 지원하는 라우터, 스위치를 사용해야합니다. 라우터와 스위치가 멀티캐스트를 지원하지 않는다면 라우터는 멀티캐스트를 브로드캐스트로 인식해 막아버리고, 스위치는 모든 포트로 뿌립니다.

또한 멀티캐스트는 IP 클래스D를 사용합니다.